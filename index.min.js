const express=require("express"),http=require("http"),bodyParser=require("body-parser"),mongoose=require("mongoose"),cors=require("cors"),app=express(),{port:port,db_uri:db_uri}=require("./config"),apiRoutes=require("./api-routes");app.use(bodyParser.urlencoded({extended:!0})),app.use(bodyParser.json()),mongoose.connect(db_uri,{useNewUrlParser:!0});const db=mongoose.connection;db?console.log("DB connected successfully"):console.error("Error connecting db"),app.use(cors({origin:"*",credentials:!0})),app.use("/",express.static("public")),app.use("/api",apiRoutes),app.use(function(e,o,r){o.header("Access-Control-Allow-Origin","*"),o.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),o.header("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),r()}),app.listen(port||8e3,function(){console.log("Running server on port "+port)});const httpGet=e=>http.get(e);setInterval(()=>httpGet("http://headway-json.herokuapp.com"),3e5);